<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Persisted Queries · Hot Chocolate</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Persisted queries are a great way to improve the performance of your GraphQL server."/><meta name="docsearch:version" content="10.2.0-preview.4"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Persisted Queries · Hot Chocolate"/><meta property="og:type" content="website"/><meta property="og:url" content="https://hotchocolate.io/"/><meta property="og:description" content="Persisted queries are a great way to improve the performance of your GraphQL server."/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://hotchocolate.io/img/cupcake.png"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/monokai-sublime.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-72800164-3', 'auto');
              ga('send', 'pageview');
            </script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lobster:700,400"/><link rel="stylesheet" href="/css/code-block-buttons.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.0/clipboard.min.js"></script><script type="text/javascript" src="/js/code-block-buttons.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/prism.css"/><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/signet.svg" alt="Hot Chocolate"/><h2 class="headerTitleWithLogo">Hot Chocolate</h2></a><a href="/versions"><h3>10.2.0-preview.4</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/10.2.0-preview.4/introduction" target="_self">Docs</a></li><li class=""><a href="/docs/10.2.0-preview.4/example-star-wars-code-first" target="_self">Examples</a></li><li class=""><a href="https://chillicream.com/blog" target="_blank">Blog</a></li><li class=""><a href="https://shop.chillicream.com" target="_blank">Shop</a></li><li class=""><a href="https://github.com/ChilliCream/hotchocolate" target="_blank">GitHub</a></li><li class=""><a target="_self"></a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>API Reference</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Introduction<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/code-first">Code-first</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/schema-first">Schema-first</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">API Reference<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Schema Definition</h4><ul><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/schema">Schema</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/schema-object-type">Object Type</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/schema-interface-type">Interface Type</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/schema-union-type">Union Type</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/schema-input-object-type">Input Object Type</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/schema-enum-type">Enum Type</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/schema-descriptions">Schema Descriptions</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/custom-scalar-types">Scalar Type Support</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/resolvers">Resolvers</a></li></ul></div><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/dataloaders">Data Loaders</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/pagination">Pagination</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/filters">Filter and Sorting Support</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/dependency-injection">Dependency Injection</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/authorization">Authorization</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/middleware">Middleware</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/custom-context">Custom Context Data</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/code-first-subscription">Subscriptions</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/options">Options</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/type-conversion">Type Conversion</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/aspnet">ASP.NET</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/parser">Parser</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/errors">Error Filter</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/security">Security</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/validation-rule">Validation Rules</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/stitching">Schema Stitching</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/instrumentation">Instrumentation</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/apollo-tracing">Apollo Tracing</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/conventions">Conventions</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/extending-types">Extending Types</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/relay">Relay</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/batching">Batching</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/10.2.0-preview.4/persisted-queries">Persisted Queries</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Guides<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/migration">Migrating from 0.6.x</a></li><li class="navListItem"><a class="navItem" href="/docs/10.2.0-preview.4/dotnet-cli">.NET CLI</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/ChilliCream/hotchocolate-docs/edit/master/docs/persisted-queries.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Persisted Queries</h1></header><article><div><span><p>Persisted queries are a great way to improve the performance of your GraphQL server.</p>
<p>Persisted queries are validated once no matter if your server restarts or your cache is cleared.</p>
<p>Persisted queries are stored close to your server either in the file system or in a <em>Redis</em> cache this helps to reduce request sizes since your application can send in a query key instead of the whole query.</p>
<p><em>Hot Chocolate</em> supports out of the box two flows how to handle persisted queries.</p>
<h2><a class="anchor" aria-hidden="true" id="ahead-of-time-query-persistence"></a><a href="#ahead-of-time-query-persistence" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Ahead of Time Query Persistence</h2>
<p>The first approach is to store queries ahead of time (ahead of deployment of your application). This can be done by extracting the queries from you client application, hashing them and pushing them to the query storage.</p>
<p>Both <em>Relay</em> and <em>Apollo</em> support this use-case and will provide the relevant hashes.</p>
<p><strong>How do we setup <em>Hot Chocolate</em> for that?</strong></p>
<p>Persisted queries are by default disabled, or even more so the middleware that handles all of this is not even plugged in.</p>
<p>In order to enable this, we will use the query execution builder to opt into a different execution pipeline.</p>
<pre><code class="hljs css language-csharp">services<span class="token punctuation">.</span><span class="token function">AddGraphQL</span><span class="token punctuation">(</span>
    s <span class="token operator">=></span> SchemaBuilder<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    b <span class="token operator">=></span>  b<span class="token punctuation">.</span><span class="token function">UsePersistedQueryPipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">AddSha256DocumentHashProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>So, with two extra lines in our schema initialization we have opted into the persisted query pipeline and opted to use SHA-256 to hash our query document. <em>Hot Chocolate</em> supports out of the box MD5, SHA-1, SHA-256.</p>
<p>OK, Next, we need to add our query storage, since we only need to read from our query storage, we can opt to use a read-only query storage like the following:</p>
<pre><code class="hljs css language-csharp">services<span class="token punctuation">.</span><span class="token function">AddReadOnlyRedisQueryStorage</span><span class="token punctuation">(</span>s <span class="token operator">=></span> s<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetRequiredService</span><span class="token punctuation">&lt;</span><span class="token class-name">ConnectionMultiplexer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Alternatively, to <em>Redis</em> we can also use the local file system to load queries:</p>
<pre><code class="hljs css language-csharp">services<span class="token punctuation">.</span><span class="token function">AddReadOnlyFileSystemQueryStorage</span><span class="token punctuation">(</span><span class="token string">"/usr/temp/queries"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>With that we have pretty much configured our server to use query persistence. The next thing you would have to do is to rework your <em>Relay</em> or <em>Apollo</em> build scripts in order to export your query to your chosen storage. The queries are stored as plain document and have to have the hash as the name without any extension. In case of the file system the hash is saved as URL compliant base64, in case if the <em>Redis</em> storage the key is the has as standard base64.</p>
<p>In your requests to the server you usually send the query wrapped in the JSON request like the following:</p>
<pre><code class="hljs css language-json"><span class="token punctuation">{</span>
  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token string">"{ foo { bar } }"</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Instead of doing that we can now just specify the request like the following:</p>
<pre><code class="hljs css language-json"><span class="token punctuation">{</span>
  <span class="token property">"namedQuery"</span><span class="token operator">:</span> <span class="token string">"W5vrrAIypCbniaIYeroNnw=="</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>Read more about how to do persisted queries with <a href="https://relay.dev/docs/en/persisted-queries.html">Relay</a>.
Read more about how to do persisted queries with <a href="https://blog.apollographql.com/persisted-graphql-queries-with-apollo-client-119fd7e6bba5">Apollo</a>.</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="active-query-persistence"></a><a href="#active-query-persistence" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Active Query Persistence</h2>
<p>Active query persistence builds upon the query persistence pipeline and adds the ability to store queries on the fly.</p>
<p><strong>How dies this work?</strong></p>
<p>The client would have a flow that would always first ask the server for the query with the query hash.</p>
<p>If the server can find the query in the query storage the server will execute it and return the result just like the <em>ahead of time persistence</em> and if the server could not find the query then again like the <em>ahead of time persistence</em> the server would return a GraphQL error that the query was not found.</p>
<pre><code class="hljs css language-json"><span class="token punctuation">{</span>
  <span class="token property">"errors"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">"message"</span><span class="token operator">:</span> <span class="token string">"PersistedQueryNotFound"</span><span class="token punctuation">,</span>
      <span class="token property">"extensions"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"code"</span><span class="token operator">:</span> <span class="token string">"PERSISTED_QUERY_NOT_FOUND"</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
<blockquote>
<p>The error message and properties can be modified by adding a <code>IErrorFilter</code> that handles the specified error-code.</p>
</blockquote>
<p>When the client receives this error message the client will the issue a full JSON request with the GraphQL query and the query hash.</p>
<pre><code class="hljs css language-json"><span class="token punctuation">{</span>
  <span class="token property">"query"</span><span class="token operator">:</span> <span class="token string">"{ foo { bar } }"</span><span class="token punctuation">,</span>
  <span class="token property">"extensions"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"persistedQuery"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"sha256Hash"</span><span class="token operator">:</span> <span class="token string">"W5vrrAIypCbniaIYeroNnw=="</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>If the query matches the server query hash the server will store the query in the query persistence storage and execute it. The server response would look like the following:</p>
<pre><code class="hljs css language-json"><span class="token punctuation">{</span>
  <span class="token property">"data"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"foo"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"bar"</span> <span class="token operator">:</span> <span class="token string">"baz"</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">"extensions"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"persistedQuery"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"sha256Hash"</span><span class="token operator">:</span> <span class="token string">"W5vrrAIypCbniaIYeroNnw=="</span><span class="token punctuation">,</span>
      <span class="token property">"persisted"</span><span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>All calls after that will use again only the hash. Since we only ever once per query will have to issue two calls, we will have over the application lifetime no overhead at all.</p>
<p><strong>How do we set this up?</strong></p>
<p>Again, we have to divert from the default query pipeline, this time we will use the <code>UseActivePersistedQueryPipeline</code> that can also handle storing queries into our query storage.</p>
<pre><code class="hljs css language-csharp">services<span class="token punctuation">.</span><span class="token function">AddGraphQL</span><span class="token punctuation">(</span>
    s <span class="token operator">=></span> SchemaBuilder<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
        <span class="token punctuation">.</span><span class="token function">Create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    b <span class="token operator">=></span>  b<span class="token punctuation">.</span><span class="token function">UseActivePersistedQueryPipeline</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">AddSha256DocumentHashProvider</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>So, with two extra lines in our schema initialization we have opted into the active persisted query pipeline and opted to use SHA-256 to hash our query document. <em>Hot Chocolate</em> supports out of the box MD5, SHA-1, SHA-256.</p>
<p>Next, we need to add our query storage, this time we need a storage to which we can write to.</p>
<pre><code class="hljs css language-csharp">services<span class="token punctuation">.</span><span class="token function">AddRedisQueryStorage</span><span class="token punctuation">(</span>s <span class="token operator">=></span> s<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetRequiredService</span><span class="token punctuation">&lt;</span><span class="token class-name">ConnectionMultiplexer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">GetDatabase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Alternatively, to <em>Redis</em> we can also use the local file system to load queries:</p>
<pre><code class="hljs css language-csharp">services<span class="token punctuation">.</span><span class="token function">AddFileSystemQueryStorage</span><span class="token punctuation">(</span><span class="token string">"/usr/temp/queries"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>OK that’s it.</p>
<blockquote>
<p>We are currently working on enabling this flow with <em>Relay</em>. Stay tuned for updates on this one.
Read more about how to do active persisted queries with <a href="https://medium.com/open-graphql/graphql-dynamic-persisted-queries-eb259700f1d3">Apollo</a>.</p>
</blockquote>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 2019-9-24 by Florian Rohrer</em></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/10.2.0-preview.4/batching"><span class="arrow-prev">← </span><span>Batching</span></a><a class="docs-next button" href="/docs/10.2.0-preview.4/migration"><span>Migrating from 0.6.x</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#ahead-of-time-query-persistence">Ahead of Time Query Persistence</a></li><li><a href="#active-query-persistence">Active Query Persistence</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/signet.svg" alt="Hot Chocolate" width="64" height="64"/></a><div><h5>Docs</h5><a href="/docs/introduction.html">Quickstart</a><a href="/docs/code-first.html">Code-First</a><a href="/docs/options.html">General</a></div><div><h5>Examples</h5><a href="/docs/example-star-wars-code-first.html">Star Wars</a></div><div><h5>Community</h5><a href="https://join.slack.com/t/hotchocolategraphql/shared_invite/enQtNTA4NjA0ODYwOTQ0LTViMzA2MTM4OWYwYjIxYzViYmM0YmZhYjdiNzBjOTg2ZmU1YmMwNDZiYjUyZWZlMzNiMTk1OWUxNWZhMzQwY2Q" target="_blank" rel="noreferrer noopener">Join us on Slack</a><a href="https://twitter.com/Chilli_Cream" target="_blank" rel="noreferrer noopener">Follow us on Twitter</a><a href="http://stackoverflow.com/questions/tagged/hotchocolate" target="_blank" rel="noreferrer noopener">Stack Overflow</a></div><div><h5>More</h5><a href="https://chillicream.com/blog" target="_blank">Blog</a><a href="https://shop.chillicream.com" target="_blank">Shop</a><a href="https://github.com/ChilliCream/hotchocolate" target="_blank">GitHub</a><a href="https://github.com/ChilliCream/hotchocolate/issues" target="_blank">Issues</a><a class="github-button" href="https://github.com/ChilliCream/hotchocolate" data-icon="octicon-star" data-count-href="/chillicream/hotchocolate/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><section class="copyright">Copyright © 2019 <a href="https://chillicream.com" target="_blank">ChilliCream</a></section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>window.twttr=(function(d,s, id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return t;js=d.createElement(s);js.id=id;js.src='https://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js, fjs);t._e = [];t.ready = function(f) {t._e.push(f);};return t;}(document, 'script', 'twitter-wjs'));</script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '47d61652587888cd5144dcdd6fb9117b',
                indexName: 'hotchocolate',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["language:en","version:10.2.0-preview.4"]}
              });
            </script></body></html>