<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Directives · Hot Chocolate</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="## Introduction"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Directives · Hot Chocolate"/><meta property="og:type" content="website"/><meta property="og:url" content="https://hotchocolate.io/index.html"/><meta property="og:description" content="## Introduction"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://hotchocolate.io/img/cupcake.png"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atelier-dune-light.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-72800164-3', 'auto');
              ga('send', 'pageview');
            </script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lobster:700,400"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/signet.svg" alt="Hot Chocolate"/><h2 class="headerTitleWithLogo">Hot Chocolate</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/introduction" target="_self">Docs</a></li><li class=""><a href="/docs/example-star-wars-code-first" target="_self">Examples</a></li><li class=""><a href="https://chillicream.com/blog" target="_blank">Blog</a></li><li class=""><a href="https://github.com/ChilliCream/hotchocolate" target="_blank">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>General</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Quickstart</h3><ul><li class="navListItem"><a class="navItem" href="/docs/introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/code-first">Code-first</a></li><li class="navListItem"><a class="navItem" href="/docs/schema-first">Schema-first</a></li><li class="navListItem"><a class="navItem" href="/docs/dotnet-cli">.NET CLI</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Code-First</h3><ul><li class="navListItem"><a class="navItem" href="/docs/code-first-introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/code-first-resolvers">Resolvers</a></li><li class="navListItem"><a class="navItem" href="/docs/code-first-object-type">Object Type</a></li><li class="navListItem"><a class="navItem" href="/docs/code-first-interface-type">Interface Type</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">General</h3><ul><li class="navListItem"><a class="navItem" href="/docs/general-schema-options">Schema Options</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/directive-middleware">Directives</a></li><li class="navListItem"><a class="navItem" href="/docs/dependency-injection">Dependency Injection</a></li><li class="navListItem"><a class="navItem" href="/docs/custom-scalar-types">Custom Scalar Types.</a></li><li class="navListItem"><a class="navItem" href="/docs/dataloaders">DataLoaders</a></li></ul></div></div></section></div><script>
            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docMainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/ChilliCream/hotchocolate-docs/edit/master/docs/directive-middleware.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 class="postHeaderTitle">Directives</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="introduction"></a><a href="#introduction" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Introduction</h2>
<p>Directives provide a way in GraphQL to add annotations to the type system or query elements. These annotations can be used to provide meta data for code generators or even to change the execution behavior of the query engine on a GraphQL server.</p>
<p>You can specify a directive by inehriting from <code>DirectiveType</code>:</p>
<pre><code class="hljs css language-csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MyDirective</span>
    : <span class="hljs-title">DirectiveType</span>
{
    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Configure</span>(<span class="hljs-params">IDirectiveTypeDescriptor descriptor</span>)
    </span>{
        descriptor.Name(<span class="hljs-string">"my"</span>);
        descriptor.Location(DirectiveLocation.Field);
    }
}
</code></pre>
<p>In order to use a directive it has to be registered with the schema.</p>
<pre><code class="hljs css language-csharp">Schema.Create(c =&gt; 
{
    c.RegisterDirective&lt;MyDirective&gt;();
});
</code></pre>
<p>GraphQL specifies three directives in the spec (skip, include and depricated) which are always registered with your schema.</p>
<p>The skip and include directives can be used in queries to in- or exclude fields from your query.</p>
<pre><code class="hljs css language-graphql">query foo($hideField: <span class="hljs-built_in">Boolean</span> = <span class="hljs-literal">false</span>){
    hello @<span class="hljs-keyword">skip</span>(<span class="hljs-keyword">if</span>: $hideField)
}
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="typed-arguments"></a><a href="#typed-arguments" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Typed Arguments</h2>
<p>Directive can have arguments that can be used to make them more flexible. So, if we had a directive like the following:</p>
<pre><code class="hljs css language-csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">MyDirective</span>
    : <span class="hljs-title">DirectiveType</span>
{
    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Configure</span>(<span class="hljs-params">IDirectiveTypeDescriptor descriptor</span>)
    </span>{
        descriptor.Name(<span class="hljs-string">"my"</span>);
        descriptor.Argument(<span class="hljs-string">"name"</span>).Type&lt;NonNullType&lt;StringType&gt;&gt;();
        descriptor.Location(DirectiveLocation.Object);
    }
}
</code></pre>
<p>We could associate the <code>MyDirective</code> with an object like this:</p>
<pre><code class="hljs css language-csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">FooType</span>
    : <span class="hljs-title">ObjectType</span>
{
    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Configure</span>(<span class="hljs-params">IObjectTypeDescriptor descriptor</span>)
    </span>{
        descriptor.Name(<span class="hljs-string">"Foo"</span>);
        descriptor.Directive(<span class="hljs-string">"my"</span>, <span class="hljs-keyword">new</span> StringValue(<span class="hljs-string">"bar"</span>));
        ...
    }
}
</code></pre>
<p>Adding directives just with their name is not type safe and could lead to runtime errors which can be avoided by using our generic variant of the directive type. The generic directive type declares the .net type that represents the directive instance.</p>
<pre><code class="hljs css language-csharp">public class MyDirectiveType
    : DirectiveType&lt;MyDirective&gt;
{
    protected override void Configure(IDirectiveTypeDescriptor descriptor)
    {
        descriptor.Name("my");
        ...
    }
}

public class MyDirective
{
    public string Name { get; set; }
}
</code></pre>
<p>The generic directive type works similar to the generic input object type. The directive descriptor will automatically try to discover any properties and expose those as arguments.</p>
<p>So, with our new directive in place we could now add it to our object type like the following:</p>
<pre><code class="hljs css language-csharp"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title">FooType</span>
    : <span class="hljs-title">ObjectType</span>
{
    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Configure</span>(<span class="hljs-params">IObjectTypeDescriptor descriptor</span>)
    </span>{
        descriptor.Name(<span class="hljs-string">"Foo"</span>);
        descriptor.Directive(<span class="hljs-keyword">new</span> MyDirective { Name = <span class="hljs-string">"bar"</span> });
        ...
    }
}
</code></pre>
<p>Since, the directive instance that we have added to our type is now a strong .net type we do not have to fear changes to the directive structure or it`s name anymore.</p>
<h2><a class="anchor" aria-hidden="true" id="middleware"></a><a href="#middleware" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Middleware</h2>
<p>What makes directive with Hot Cocolate very useful is the ability to associate a middleware with it that overwrites / alternates the default resolver behaviour of a field.</p>
<p>In order to add a middleware to a directive you could declare it with the descriptor as a delegate.</p>
<pre><code class="hljs css language-csharp">public class MyDirectiveType
    : DirectiveType&lt;MyDirective&gt;
{
    protected override void Configure(IDirectiveTypeDescriptor descriptor)
    {
        descriptor.Name("my");
        descriptor.Location(DirectiveLocation.Object);
        descriptor.Middleware(next =&gt; context =&gt;
        {
            context.Result = "Bar";
            return next.Invoke();
        })
    }
}

public class MyDirective
{
    public string Name { get; set; }
}
</code></pre>
<p>Directives with middleware or executable directives can be put on object types and on their field definitions or on the field selection in a query. Executable directives on an object type will replace the field resolver of every field of the annotated object type.</p>
<h3><a class="anchor" aria-hidden="true" id="order"></a><a href="#order" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Order</h3>
<p>In GraphQL the directive order is significant and with our middleware we use the order of directives to create a resolver pipeline through which the result flows.</p>
<p>The resolver pipeline consists of a sequence of directive delegates, called one after the other.</p>
<p>Each delegate can perform operations before and after the next delegate. A delegate can also decide to not pass a resolver request to the next delegate, which is called short-circuiting the resolver pipeline. Short-circuiting is often desirable because it avoids unnecessary work.</p>
<p>The order of middleware pipeline is defined by the order of the directives. Since, executable directives will flow from the object type to its field definitions the directives of the type would be called first in the order that they were annotated.</p>
<pre><code class="hljs css language-graphql"><span class="hljs-selector-tag">type</span> <span class="hljs-selector-tag">Query</span> {
    <span class="hljs-attribute">foo</span>: Bar
}

<span class="hljs-selector-tag">type</span> <span class="hljs-selector-tag">Bar</span> @<span class="hljs-selector-tag">a</span> @<span class="hljs-selector-tag">b</span> {
    <span class="hljs-attribute">baz</span>: String <span class="hljs-variable">@c</span> <span class="hljs-variable">@d</span>
}
</code></pre>
<p>So, the directives in the above example would be called in the following order <code>a, b, c, d</code>.</p>
<p>If there were more directives in the query, they would be appended to the directives from the type.</p>
<pre><code class="hljs css language-graphql">{
    foo {
        baz <span class="hljs-meta">@e</span> <span class="hljs-meta">@f</span>
    }
}
</code></pre>
<p>So, now the order would be like the following: <code>a, b, c, d, e, f</code>.</p>
<p>Since, a middleware pipline effectively replaces the original resolver function every middleware can execute the original resolver by calling <code>ResolveAsync()</code> on the <code>IDirecvtiveContext</code>.</p>
<h3><a class="anchor" aria-hidden="true" id="method-binding"></a><a href="#method-binding" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Method Binding</h3>
<p>A middleware can be bound to methods like with field resolvern and make use of argument injection.</p>
<pre><code class="hljs css language-csharp">public class MyDirectiveType
    : DirectiveType&lt;MyDirective&gt;
{
    protected override void Configure(IDirectiveTypeDescriptor descriptor)
    {
        descriptor.Name("my");
        descriptor.Location(DirectiveLocation.Object);
        descriptor.Middleware(next =&gt; context =&gt;
        {
            context.Result = "Bar";
            return next.Invoke();
        })
    }
}

public class MyDirective
{
    public string Name { get; set; }
}

public class CustomMiddleware
{
    public string Foo(MyDirective directive)
    {
        return directive.Name;
    }
}
</code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/general-schema-options"><span class="arrow-prev">← </span><span>Previous</span></a><a class="docs-next button" href="/docs/dependency-injection"><span>Next</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav docOnPageNav"><ul class="toc-headings"><li><a href="#introduction">Introduction</a></li><li><a href="#typed-arguments">Typed Arguments</a></li><li><a href="#middleware">Middleware</a><ul class="toc-headings"><li><a href="#order">Order</a></li><li><a href="#method-binding">Method Binding</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/signet.svg" alt="Hot Chocolate" width="64" height="64"/></a><div><h5>Docs</h5><a href="/docs/introduction.html">Quickstart</a><a href="/docs/code-first-introduction.html">Code-First</a><a href="/docs/general-schema-options.html">General</a></div><div><h5>Examples</h5><a href="/docs/example-star-wars-code-first.html">Star Wars</a></div><div><h5>Community</h5><a href="https://twitter.com/Chilli_Cream" target="_blank" rel="noreferrer noopener">Follow us on Twitter</a><a href="http://stackoverflow.com/questions/tagged/hotchocolate" target="_blank" rel="noreferrer noopener">Stack Overflow</a></div><div><h5>More</h5><a href="https://chillicream.com/blog" target="_blank">Blog</a><a href="https://github.com/ChilliCream/hotchocolate" target="_blank">GitHub</a><a href="https://github.com/ChilliCream/hotchocolate/issues" target="_blank">Issues</a><a class="github-button" href="https://github.com/ChilliCream/hotchocolate" data-icon="octicon-star" data-count-href="/chillicream/hotchocolate/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><section class="copyright">Copyright © 2018 <a href="https://chillicream.com" target="_blank">ChilliCream</a></section></footer></div><script>window.twttr=(function(d,s, id){var js,fjs=d.getElementsByTagName(s)[0],t=window.twttr||{};if(d.getElementById(id))return t;js=d.createElement(s);js.id=id;js.src='https://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js, fjs);t._e = [];t.ready = function(f) {t._e.push(f);};return t;}(document, 'script', 'twitter-wjs'));</script></body></html>